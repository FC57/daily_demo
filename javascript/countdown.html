<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="Generator" content="EditPlus®" />
    <meta name="Author" content="" />
    <meta name="Keywords" content="" />
    <meta name="Description" content="" />
    <title>倒计时案例效果</title>
    <style>
      * {
        margin: 0px;
        padding: 0px;
      }

      body {
        background: #000000;
      }

      .container {
        width: 600px;
        height: 400px;
        border: 1px solid #000;
        margin: 150px auto 0;
      }

      .con {
        width: 490px;
        height: 160px;
        /* background: #000; */
        margin: 100px auto;
        /* box-shadow: 0px 0px 10px #000; */
        padding-top: 40px;
        padding-left: 40px;
      }

      .con .time-item {
        color: #fff;
        width: 65px;
        height: 120px;
        float: left;
        overflow: hidden;
      }

      .time-item ul {
        position: relative;
        /* transition: all .5s linear; */
        font-size: 0;
        top: 0px;
      }

      .con .time {
        width: 30px;
        text-align: center;
        line-height: 120px;
        font-weight: bold;
        float: left;
        color: #fff;
      }

      p {
        color: #fff;
        margin-top: -30px;
        font-weight: bold;
        font-size: 22px;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <p>距离活动结束时间：</p>
      <div class="con">
        <div class="time-item">
          <ul>
            <li><img src="/assets/imgs/2.png" /></li>
            <li><img src="/assets/imgs/1.png" /></li>
            <li><img src="/assets/imgs/0.png" /></li>
          </ul>
        </div>
        <div class="time-item">
          <ul>
            <li><img src="/assets/imgs/3.png" /></li>
            <li><img src="/assets/imgs/2.png" /></li>
            <li><img src="/assets/imgs/1.png" /></li>
            <li><img src="/assets/imgs/0.png" /></li>
            <li><img src="/assets/imgs/9.png" /></li>
            <li><img src="/assets/imgs/8.png" /></li>
            <li><img src="/assets/imgs/7.png" /></li>
            <li><img src="/assets/imgs/6.png" /></li>
            <li><img src="/assets/imgs/5.png" /></li>
            <li><img src="/assets/imgs/4.png" /></li>
          </ul>
        </div>
        <div class="time">时</div>
        <div class="time-item">
          <ul>
            <li><img src="/assets/imgs/5.png" /></li>
            <li><img src="/assets/imgs/4.png" /></li>
            <li><img src="/assets/imgs/3.png" /></li>
            <li><img src="/assets/imgs/2.png" /></li>
            <li><img src="/assets/imgs/1.png" /></li>
            <li><img src="/assets/imgs/0.png" /></li>
          </ul>
        </div>
        <div class="time-item">
          <ul>
            <li><img src="/assets/imgs/9.png" /></li>
            <li><img src="/assets/imgs/8.png" /></li>
            <li><img src="/assets/imgs/7.png" /></li>
            <li><img src="/assets/imgs/6.png" /></li>
            <li><img src="/assets/imgs/5.png" /></li>
            <li><img src="/assets/imgs/4.png" /></li>
            <li><img src="/assets/imgs/3.png" /></li>
            <li><img src="/assets/imgs/2.png" /></li>
            <li><img src="/assets/imgs/1.png" /></li>
            <li><img src="/assets/imgs/0.png" /></li>
          </ul>
        </div>
        <div class="time">分</div>
        <div class="time-item">
          <ul>
            <li><img src="/assets/imgs/5.png" /></li>
            <li><img src="/assets/imgs/4.png" /></li>
            <li><img src="/assets/imgs/3.png" /></li>
            <li><img src="/assets/imgs/2.png" /></li>
            <li><img src="/assets/imgs/1.png" /></li>
            <li><img src="/assets/imgs/0.png" /></li>
          </ul>
        </div>
        <div class="time-item">
          <ul>
            <li><img src="/assets/imgs/9.png" /></li>
            <li><img src="/assets/imgs/8.png" /></li>
            <li><img src="/assets/imgs/7.png" /></li>
            <li><img src="/assets/imgs/6.png" /></li>
            <li><img src="/assets/imgs/5.png" /></li>
            <li><img src="/assets/imgs/4.png" /></li>
            <li><img src="/assets/imgs/3.png" /></li>
            <li><img src="/assets/imgs/2.png" /></li>
            <li><img src="/assets/imgs/1.png" /></li>
            <li><img src="/assets/imgs/0.png" /></li>
          </ul>
        </div>
        <div class="time">秒</div>
      </div>
    </div>

    <script>
      let hourNode = null;
      const timerIds = [];
      let seconds = 0;
      function changeTimeNumber(node, timer, isSeconds = false) {
        let firstChild = null;
        /* 定义动画执行完成时间 */
        node.addEventListener('transitionend', () => {
          /* 改变动画的执行transition属性 为空 */
          node.style.transition = 'none';
          /* 恢复变形 */
          node.style.transform = 'none';
          /* 追加第一个元素准备进行第二次动画 */
          node.appendChild(firstChild);
        });
        const timerId = setInterval(() => {
          /* 获取第一个子节点，准备进行添加操作 */
          /* 规定执行动画时间, */
          /* 调整显示位置 */
          firstChild = node.children[0];
          node.style.transition = 'all .5s linear';
          node.style.transform = 'translateY(-120px)';
          if (isSeconds) {
            seconds++;
            if (seconds === 1000 * 60 * 60 * 4) {
              clearInterval(timerIds.pop());
              timerIds.push(changeTimeNumber(hourNode, 360000000));
            }
            if (seconds === 1000 * 60 * 60 * 24 - 1) {
              timerIds.forEach(id => {
                clearInterval(id);
              });
            }
          }
        }, timer);
        return { node, timerId };
      }

      (() => {
        const doms = document.getElementsByClassName('time-item');
        const timerArr = [108000000, 36000000, 600000, 60000, 10000, 1000];
        for (let i = doms.length - 1; i >= 0; i--) {
          const { timerId, node } = changeTimeNumber(
            doms[i].getElementsByTagName('ul')[0],
            timerArr[i],
            i === doms.length - 1
          );
          timerIds.push(timerId);
          if (i === 0) {
            hourNode = node;
          }
        }
      })();
    </script>
  </body>
</html>
